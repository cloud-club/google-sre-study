---
writer: jiwon
date: 2025-04-13
---

# Chapter 12 - Effective Troubleshooting

## Summary

- 장애조치는 분산 컴퓨팅 시스템을 운영하는 모든 사람들에게 필수적
- 장애 조치를 연습하기 위해서는 범용적으로 수행하는 방법 훈련과, 시스템에 대한 탄탄한 이해가 필요하다.
- 통상 애플리케이션의 장애 조치 방법은 시스템을 관찰한 결과와 시스템의 행동에 대한 이해를 바탕으로 한 이론적 기반을 토대로 장애의 잠재적 원인에 대해 계속해서 가설을 세워나가고 시험하는 방법이다.
- 문제 발생 보고 → 데이터를 기반으로 사태 파악 → 가설 설정 → 테스트 → 결과를 토대로 수용/ 가설 재설정
- 근본 원인이 발견될 때까지 계속해서 테스트를 수행하고 장애 재발을 방지하기 위한 조치를 수행해야 함
- 어떠한 현상들이 연관되었다고 원인이 되지는 않는다.

## 실전

### 문제 보고

- 자동화를 통해 사전에 서술된 문제는 자기 복구까지 가능하도록 하는 것이 좋다.
- 특정한 사람에게 오류를 보고하기 보다는 팀에 보고하여 책임을 나누고 빠른 해결이 가능하도록 한다.

### 문제의 우선순위 판단

- 문제의 영향도에 따라 대응 방안을 선별해야 한다.
- 문제 발생 시 근본 원인을 빨리 찾고 싶겠지만, **우선 시스템이 가능한 정상적으로 동작하게 만들어야 한다.**
- 복구가 불가능할 정도라면 더 큰 손실을 방지하기 위해 시스템을 중단한다.

### 문제 관찰하기

### 진단

- 단순화하기와 범위를 좁히기
  - 컴포넌트 단위로 연결을 확인하여 에러 지점을 확인할 수 있다.
- “무엇이, 어디서, 왜”를 고민하기
  - 오류가 발생한 시스템은 의외의 동작을 계속 실행하고 있을 가능성이 크다.
  - 그래서 시스템의 동작을 확인하고 자원의 출처와 원인, 결과를 살펴보면 오류 이해에 도움이 된다.
- 가장 마지막으로 수정된 부분에 주목하기
  - 시스템은 관성이 있기에 변경이나 서비스 부하의 종류가 바뀌는 등 외부 요인이 발생하기 전까지는 계속해서 동작하려 한다.
  - 그래서 가장 최근에 변경된 부분을 확인하는 것은 좋은 접근이다.
- 서비스에 특화된 진단
  - 이런 범용 도구들은 광범위한 문제를 인지하는 데에는 도움이 되지만 아무래도 직접 개발하여 효과를 극대화할 수 있다.

### 테스트와 조치

- 이상적인 테스트는 상호 배타적이어서 어느 한 집합을 검증함으로써 다른 가설의 가능성이 없음을 밝힐 수 있어야 한다.
- 가장 명확한 것을 최우선으로 고려한다
  - 가능성이 큰 테스트부터 순차적으로 진행하며 테스트로 인해 시스템에 발생할 수 있는 위험에 대해서도 고려해야 한다.
- 혼란 요소로 인해 특정 실험이 잘못된 결과를 도출할 수도 있다.
- 적극적인 테스트가 나중에 실행할 테스트의 결과에 부작용을 초래할 수 있다.
  - 과도한 로깅은 지연응답을 발생시켜 테스트에 혼란을 줄 수 있다.
- 일부 테스트는 설득력이 떨어질 수 있다.
  - 정기적이며 반복 가능한 상태로 경쟁 상태나 데드락이 발생한 상황을 인위적으로 만들어내기는 어려우므로 비교적 불확실한 증거임에도 그것에 만족해야 할 수도 있다.
- 어떠한 생각으로 어떤 테스트를 수행했고, 그 결과는 어떠하였는지 꼼꼼히 기록하여야 한다.
  - 이는 롤백에도 도움이 된다.

## 부정적인 결과의 마법

- 부정적인 결과 : 기대한 효과가 나타나지 않은 경우
- 부정적인 결과는 스스로의 잘못을 인식하게 한다.
  - 프로덕션 환경이나 디자인 공간 혹은 기존 시스템의 성능 한계 등을 확실히 알 수 있다.
  - 자신의 실험이나 디자인의 가치를 알 수 있다.
  - 포괄적이거나 그 의미가 확실한 부정적인 결과는 추후 도움이 된다.
- 도구와 방법은 실험의 결과와는 무관하며 향후의 작업에 대한 단서가 된다.
  - 반복적인 실험을 위한 도구를 직접 구현하는 것도 좋다.
- 부정적인 결과를 공표하는 것은 업계의 데이터 주도 성향을 증진시킨다.
  - 부정적이고 의미 없는 데이터에 대한 자세한 기록은 지표에 대한 편견을 해소하고, 측정된 데이터에 근거해 불확실성을 이해하게 하는 좋은 예다.
- 자신의 결과를 공표하자
  - 부정적인 결과는 신중하게 위험을 받아들이는 과정의 일부이다.
  - 트러블 슈팅 과정을 공유하며 함께 성장하는게 IT 분야의 가장 큰 매력이지 않나 싶다 ✨

### 처방

- 특정 지은 원인이 실제 문제의 원인인지 증명해야 한다.
- 하지만 프로덕션 시스템에서 이를 재현하기는 어렵기에 대부분 어느정도 확실한 요소만을 찾게 된다.
  - 테스트를 하기 위해 비슷한 별도의 환경을 구성하기에는 추가 비용이 발생한다.
- 문제를 유발하는 요소를 발견하면 시스템에서 어떤 문제가 발생했는지, 문제를 어떻게 추적해냈는지, 문제를 어떻게 해결했는지, 이 문제의 재발을 어떻게 방지할 수 있는지 기록해야 한다.

## Questions
<!-- 읽으며 궁금했던 점 -->

## Thoughts
<!-- 내 생각 -->

## Difficulties
<!-- 어려웠던 점 -->

## References
<!-- 추가 찾아본 레퍼런스 -->

## Discussion Topics
<!-- 다른 사람의 의견이 궁금한 부분 -->